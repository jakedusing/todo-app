<%- include("partials/header"); %>
<main class="container mt-5">
  <!-- Flash Messages-->
  <% if (success_msg.length > 0) {%>
  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <%= success_msg %>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  <% } %> <% if (error_msg.length > 0) {%>
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <%= error_msg %>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  <% } %>
  <h1>My Friends</h1>

  <!-- Pending Requests Received -->
  <h2>Pending Friend Requests</h2>
  <% if (pendingRequests && pendingRequests.length > 0) { %>
  <ul class="list-group mb-4">
    <% pendingRequests.forEach(request => { %>
    <li
      class="list-group-item d-flex justify-content-between align-items-center"
    >
      <span><%= request.requester.username %></span>
      <form action="/friends/accept/<%= request._id %>" method="POST">
        <button class="btn btn-success btn-sm">Accept</button>
      </form>
    </li>
    <% }); %>
  </ul>
  <% } else { %>
  <p class="text-muted">No pending requests received.</p>
  <% } %>

  <!-- Pending Requests Sent -->
  <h2>Pending Requests Sent</h2>
  <% if (sentRequests && sentRequests.length > 0) { %>
  <ul class="list-group mb-4">
    <% sentRequests.forEach(request => { %>
    <li
      class="list-group-item d-flex justify-content-between align-items-center"
    >
      <span>Request sent to <%= request.recipient.username %></span>
    </li>
    <% }); %>
  </ul>
  <% } else { %>
  <p class="text-muted">No pending requests sent.</p>
  <% } %>

  <!-- Accepted Friends -->
  <h2>Friends</h2>
  <% if (friends && friends.length > 0) { %>
  <ul class="list-group">
    <% friends.forEach(friend => { %>
    <li class="list-group-item"><%= friend.username %></li>
    <% }); %>
  </ul>
  <% } else { %>
  <p class="text-muted">No friends yet.</p>
  <% } %>
</main>
<%- include("partials/footer"); %>
